# 漏洞挖掘

专注于各种Web应用漏洞的原理分析、利用方法和防护措施。

## 🎯 漏洞分类

### 注入类漏洞
- **SQL注入** - 数据库查询注入
- **NoSQL注入** - MongoDB等NoSQL数据库注入
- **LDAP注入** - LDAP查询注入
- **命令注入** - 操作系统命令执行

### 客户端攻击
- **XSS跨站脚本** - 存储型、反射型、DOM型
- **CSRF跨站请求伪造** - 利用用户身份执行恶意操作
- **点击劫持** - UI redressing攻击

### 访问控制缺陷
- **垂直权限提升** - 获得更高权限
- **水平权限提升** - 访问同级用户数据
- **IDOR越权访问** - 直接对象引用漏洞

### 业务逻辑漏洞
- **支付逻辑绕过**
- **验证码绕过**
- **重放攻击**
- **条件竞争**

## 📊 OWASP Top 10 (2021)

| 排名 | 漏洞类型 | 风险等级 |
|------|----------|----------|
| A01 | 访问控制缺陷 | 🔴 高 |
| A02 | 加密机制失效 | 🔴 高 |
| A03 | 注入攻击 | 🟠 中高 |
| A04 | 不安全设计 | 🟠 中高 |
| A05 | 安全配置错误 | 🟠 中 |
| A06 | 易受攻击的组件 | 🟠 中 |
| A07 | 身份认证失效 | 🟠 中 |
| A08 | 软件数据完整性失效 | 🟡 中低 |
| A09 | 安全日志记录失效 | 🟡 中低 |
| A10 | 服务端请求伪造 | 🟡 低 |

## 🔍 漏洞挖掘方法

### 1. 自动化扫描
```bash
# 使用AWVS进行全面扫描
awvs_console /scan /target:http://target.com

# 使用Nuclei进行快速检测
nuclei -u http://target.com -t cves/
```

### 2. 手工测试
- 黑盒测试：不了解内部结构的测试
- 白盒测试：基于源码的安全审计
- 灰盒测试：部分了解系统的测试

### 3. 代码审计
```python
# 危险函数检测
dangerous_functions = [
    'eval', 'exec', 'system', 'shell_exec',
    'mysqli_query', 'mysql_query'
]

# SQL注入检测模式
sql_patterns = [
    r'SELECT.*FROM.*WHERE',
    r'UNION.*SELECT',
    r'INSERT.*INTO.*VALUES'
]
```

## 🛠️ 推荐工具

### 漏洞扫描器
- **Acunetix (AWVS)** - 商业Web漏洞扫描器
- **Nessus** - 综合漏洞扫描工具
- **OpenVAS** - 开源漏洞扫描器
- **Nuclei** - 快速漏洞检测工具

### 代码审计工具
- **SonarQube** - 代码质量和安全分析
- **Checkmarx** - 静态代码安全测试
- **Veracode** - 应用安全测试平台

---

> 🎯 **目标**: 通过系统性学习漏洞原理，提升安全意识和防护能力
